<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>6.1 Authorization Endpoint 1.0.0.BUILD-SNAPSHOT</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <div class="navTitle">
        
        Micronaut OAuth 2.0
    </div>
    <div class="navLinks">
        <ul>
            <li>
                <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                    <a href="../../guide/index.html" class="button">Table of contents</a>

                    <div id="nav-summary-childs" style="display:none;">
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/installation.html"><strong>1</strong><span>Installation</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/examples.html"><strong>2</strong><span>Examples</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/oauth2.html"><strong>3</strong><span>OAuth 2.0</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/openid.html"><strong>4</strong><span>Open ID Connect</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/service-discovery.html"><strong>5</strong><span>Service Discovery</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/endpoints.html"><strong>6</strong><span>Endpoints</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/providerSpecificBeans.html"><strong>7</strong><span>Provider Specific Beans</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../../guide/flows.html"><strong>8</strong><span>Flows</span></a>
                        </div>
                        
                    </div>
                </div>
            </li>
            <li class="separator selected">
                <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
            </li>
        </ul>
    </div>


</div>

<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../../guide/service-discovery.html">&lt;&lt; <strong>5</strong><span>Service Discovery</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                
                    <div class="toc-item next-right"><a href="../../guide/providerSpecificBeans.html"><strong>7</strong><span>Provider Specific Beans</span> >></a></div>
                


                <div class="project">
                    <h1>6.1 Authorization Endpoint</h1>

                    <p><strong>Version:</strong> 1.0.0.BUILD-SNAPSHOT</p>
                </div>

                
                <div id="table-of-content">
                    <h2>Table of Contents</h2>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#state"><strong>6.1</strong><span>State</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#idTokenHint"><strong>6.2</strong><span>IDToken Hint</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#loginHint"><strong>6.3</strong><span>Login Hint</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#nonce"><strong>6.4</strong><span>Nonce</span></a>
                    </div>
                    
                </div>
                

                

<h2 id="authorization">6.1 Authorization Endpoint</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/endpoints/authorization.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>If you use the Service discovery endpoint some of the configuration values required to communicate with the Authorization endpoint will be inferred from the service discovery endpoint response. For example, you will not need to configure the authorization endpoint&#8217;s url since that information is typically returned by service discovery endpoint. However, if the default values do not suffice, you can configure the communication with the authorization endpoint:</p>
</div>
<a id="io.micronaut.security.oauth2.openid.endpoints.authorization.AuthorizationEndpointConfigurationProperties" href="#io.micronaut.security.oauth2.openid.endpoints.authorization.AuthorizationEndpointConfigurationProperties">&#128279;</a>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Configuration Properties for <a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/AuthorizationEndpointConfigurationProperties.html">AuthorizationEndpointConfigurationProperties</a></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.authorization.url</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the authorization endpoint&#8217;s url.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.authorization.redirect-uri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redirection URI to which the response will be sent. Default value (<a href="http://localhost:8080/auth/code" class="bare">http://localhost:8080/auth/code</a>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.authorization.scopes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.util.List</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets OAuth 2.0 scopes. Default value (['openid', 'email', 'profile']).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.authorization.response-type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set OAuth 2.0 Response Type. Default value ({@value #DEFAULT_RESPONSETYPE}).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.authorization.response-mode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informs the Authorization Server of the mechanism to be used for returning parameters from the Authorization Endpoint. Default value ({@value #DEFAULT_RESPONSEMODE}).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.authorization.display</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/Display.html">Display</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASCII string value that specifies how the Authorization Server displays the authentication and consent user interface pages to the End-User. Default value (null).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.authorization.prompt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/Prompt.html">Prompt</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Space delimited, case sensitive list of ASCII string values that specifies whether the Authorization Server prompts the End-User for reauthentication and consent. Default value (null).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.authorization.max-age</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum Authentication Age. Default value (null).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.authorization.ui-locales</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.util.List</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">End-User&#8217;s preferred languages and scripts for the user interface. Default value (null).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.authorization.acr-values</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.util.List</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Requested Authentication Context Class Reference values. Default value (null).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The authorization request is built by default with <a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/DefaultAuthenticationRequestProvider.html">DefaultAuthenticationRequestProvider</a>. Remember you can always <a href="https://docs.micronaut.io/latest/guide/index.html#replaces">replace that bean</a> and provide your own implementation of <a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/AuthenticationRequestProvider.html">AuthenticationRequestProvider</a>.</p>
</div>


<h2 id="state">6.1.1 State</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/endpoints/authorization/state.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>By default, this library will provide a <a href="https://openid.net/specs/openid-connect-core-1_0.html#AuthRequest">state parameter</a> to authentication requests to track the original URL if the request to the URL was denied because the request was unauthorized. That allows the redirection back to the original requested resource after authentication.</p>
</div>
<div class="paragraph">
<p>Because the validation of the state requires the state to be stored somewhere temporarily, state validation is only enabled if a <a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/state/validation/persistence/StatePersistence.html">StatePersistence</a> bean is present. An implementation of state persistence that stores the state in an http session has been provided, however it must be enabled through configuration and the necessary dependencies must be on the classpath.</p>
</div>
<div class="paragraph">
<p>To enable state persistence with an http session:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add a dependency to <code>micronaut-session</code></p>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="gradle">compile <span class="hljs-string">'io.micronaut:micronaut-session'</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-session&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</p>
</div>
</li>
<li>
<p>Set the state persistence to <code>session</code></p>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre>micronaut.security.oauth2.openid.state.validation.persistence: session</pre>
</div>
</div>
<div class="paragraph">
<p>If state validation fails, an <a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/state/InvalidStateException.html">InvalidStateException</a> will be thrown.</p>
</div>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_customizing_the_state">Customizing The State</h3>
<div class="paragraph">
<p>There are several interfaces that implementations can be provided for to override how the state parameter is handled.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Responsibility</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Implementation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/state/StateFactory.html">StateFactory</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Builds a <a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/state/State.html">State</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/state/DefaultStateFactory.html">DefaultStateFactory</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/state/StateSerDes.html">StateSerDes</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Serializes and de-serializes the state object for use in the authorization request</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/state/JacksonStateSerDes.html">JacksonStateSerDes</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/state/validation/StateValidator.html">StateValidator</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Validates the state received in the authorization response</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/state/validation/DefaultStateValidator.html">DefaultStateValidator</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/state/validation/persistence/StatePersistence.html">StatePersistence</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stores the state to be retrieved later to allow validation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None unless configured</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>To override the behavior of any of those beans, provide an implementation and replace the default one.</p>
</div>
</div>


<h2 id="idTokenHint">6.1.2 IDToken Hint</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/endpoints/authorization/idTokenHint.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The default implementation does not provide an <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDToken">ID Token hint</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>A Token previously issued by the Authorization Server being passed as a hint about the End-User&#8217;s current or past authenticated session with the Client.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>However, you can provide a <a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/IdTokenHintProvider.html">IdTokenHintProvider bean</a> and it will be included in the authentication request.</p>
</div>


<h2 id="loginHint">6.1.3 Login Hint</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/endpoints/authorization/loginHint.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The default implementation does not provide an <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDToken">login hint</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Hint to the Authorization Server about the login identifier the End-User might use to log in.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>However, you can provide a <a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/LoginHintProvider.html">LoginHintProvider bean</a> and it will be included in the authentication request.</p>
</div>


<h2 id="nonce">6.1.4 Nonce</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/endpoints/authorization/nonce.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The default implementation does not provide an <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDToken">Nonce parameter</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>A String value used to associate a Client session with an ID Token, and to mitigate replay attacks.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>However, you can provide a <a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/NonceProvider.html">NonceProvider bean</a> and it will be included in the authentication request.</p>
</div>


                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../../guide/service-discovery.html">&lt;&lt; <strong>5</strong><span>Service Discovery</span></a></div>
                
                    <div class="toc-item next-right"><a href="../../guide/providerSpecificBeans.html"><strong>7</strong><span>Provider Specific Beans</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    
    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
