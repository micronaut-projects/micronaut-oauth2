<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>Micronaut OAuth 2.0</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
    <link rel="stylesheet" href="../css/custom.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />
    <link rel="stylesheet" href="../css/highlight/agate.css">
    <script src="../js/highlight.pack.js"></script>
    <script src="../js/guide.js"></script>
    <script src="../js/multi-language-sample.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="stylesheet" href="../css/multi-language-sample.css"/>
    <script src="../js/docs.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.13/clipboard.min.js"></script>
    <script type="text/javascript">
        function addJsClass(el) {
            var classes = document.body.className.split(" ");
            classes.push("js");
            document.body.className = classes.join(" ");
        }
    </script>

</head>

<body class="body" id="docs" onload="addJsClass();" onhashchange="highlightMenu()">

<div id="table-of-content-nav-link" class="desktop">
    <a title="Collapse/Open Table of contents" title="Hide Table of Contents" href="javascript:hideTableOfContents();" class="button">[ + ]</a>
</div>

<div id="main">
    <div id="navigation" class="no-print">
        <div class="navTitle">
            <span id="logo"><a href="http://micronaut.io" title="Go to Micronaut Website"><img src="../img/micronaut-logo-white.svg" alt="Micronaut"/></a></span>
        </div>
        <div class="navLinks">
            <ul>
                    <li>
                        <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)" class="desktop">
                            <a href="../guide/index.html" class="button">Table of contents</a>
                            <div id="nav-summary-childs" style="display:none;">
                                
                                <div class="toc-item" style="margin-left:0"><a href="#installation"><strong>1</strong><span>Installation</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#oauth2"><strong>2</strong><span>OAuth 2.0</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#openid"><strong>3</strong><span>Open ID Connect</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#service-discovery"><strong>4</strong><span>Service Discovery</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#endpoints"><strong>5</strong><span>Endpoints</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#providerSpecificBeans"><strong>6</strong><span>Provider Specific Beans</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#flows"><strong>7</strong><span>Flows</span></a></div>
                                
                            </div>
                        </div>
                    </li>

                <li id="table-of-content-nav-link-mobile" class="mobile">
                    <a title="Scroll to Table of contents" href="javascript:scrollToTop();" class="button">Toc</a>
                </li>
                <li class="desktop">
                    <a title="Go to API documentation" href="../api/index.html" class="button">API Reference</a>
                </li>
                <li class="mobile">
                    <a title="Go to API documentation" href="../api/index.html" class="button">API</a>
                </li>
                <li class="desktop">
                    <a title="Go to Configuration Reference documentation" href="../guide/configurationreference.html" class="button">Configuration Reference</a>
                </li>
                <li class="mobile">
                    <a title="Go to Configuration Reference documentation" href="../guide/configurationreference.html" class="button">Conf</a>
                </li>

            </ul>

        </div>
    </div>
    
    <div id="table-of-content">
        <div class="toc-content">

        <h2>Table of Contents</h2>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-installation"><a href="#installation"><strong>1</strong><span>Installation</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-oauth2"><a href="#oauth2"><strong>2</strong><span>OAuth 2.0</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-openid"><a href="#openid"><strong>3</strong><span>Open ID Connect</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-service-discovery"><a href="#service-discovery"><strong>4</strong><span>Service Discovery</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-service-discovery-okta"><a href="#service-discovery-okta"><strong>4.1</strong><span>Service Discovery with OKTA</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-service-discovery-cognito"><a href="#service-discovery-cognito"><strong>4.2</strong><span>Service Discovery with AWS Cognito</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-service-discovery-auth0"><a href="#service-discovery-auth0"><strong>4.3</strong><span>Service Discovery with Auth0</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-service-discovery-keycloak"><a href="#service-discovery-keycloak"><strong>4.4</strong><span>Service Discovery with Keycloak</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-endpoints"><a href="#endpoints"><strong>5</strong><span>Endpoints</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-authorization"><a href="#authorization"><strong>5.1</strong><span>Authorization Endpoint</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-state"><a href="#state"><strong>5.1.1</strong><span>State</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-idTokenHint"><a href="#idTokenHint"><strong>5.1.2</strong><span>IDToken Hint</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-loginHint"><a href="#loginHint"><strong>5.1.3</strong><span>Login Hint</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-nonce"><a href="#nonce"><strong>5.1.4</strong><span>Nonce</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-token"><a href="#token"><strong>5.2</strong><span>Token Endpoint</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-endsession"><a href="#endsession"><strong>5.3</strong><span>End Session Endpoint</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-logoutController"><a href="#logoutController"><strong>5.3.1</strong><span>Logout Controller</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-logouturl"><a href="#logouturl"><strong>5.3.2</strong><span>Logout URL</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-providerSpecificBeans"><a href="#providerSpecificBeans"><strong>6</strong><span>Provider Specific Beans</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-flows"><a href="#flows"><strong>7</strong><span>Flows</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-authorization-code-grant-type"><a href="#authorization-code-grant-type"><strong>7.1</strong><span>OpenID Connect Authorization code Flow</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-authorization-code-controller"><a href="#authorization-code-controller"><strong>7.1.1</strong><span>Authorization Code Controller</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-id-token-validator"><a href="#id-token-validator"><strong>7.1.2</strong><span>ID Token Validator</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-failure-handler"><a href="#failure-handler"><strong>7.1.3</strong><span>Failure Handler</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-successful-handler"><a href="#successful-handler"><strong>7.1.4</strong><span>Successful ID Token Handler</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-cookie-successful-handler"><a href="#cookie-successful-handler"><strong>7.1.5</strong><span>Cookie Successful ID Token Handler</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-password-grant-type"><a href="#password-grant-type"><strong>7.2</strong><span>Password Grant Type</span></a></div>
        
        </div>
    </div>
    
    <div class="docs-content">
    <div class="project">
        <h1>Micronaut OAuth 2.0</h1>
        <p></p>
        <p>Integration between Micronaut, OAuth 2.0 and OpenID Connect</p>
        <p><strong>Version:</strong> 1.0.0.BUILD-SNAPSHOT</p>
    </div>
    

<h1 id="installation">1 Installation</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/installation.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>This project eases OAuth 2.0 integration with Micronaut.</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="gradle">compile <span class="hljs-string">'io.micronaut.configuration:micronaut-oauth2:1.0.0.BUILD-SNAPSHOT'</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.configuration&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-oauth2&lt;/artifactId&gt;
    &lt;version&gt;1.0.0.BUILD-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</p>
</div>
<div class="paragraph">
<p>To use the <code>BUILD-SNAPSHOT</code> version of this library, check the <a href="https://docs.micronaut.io/latest/guide/index.html#usingsnapshots">documentation to use snapshots</a>.</p>
</div>
<div class="paragraph">
<p>Code can be found at the <a href="https://github.com/micronaut-projects/micronaut-oauth2">micronaut-oauth2</a> repository.</p>
</div>


<h1 id="oauth2">2 OAuth 2.0</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/oauth2.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Micronaut supports integration with authentication &amp; authorization platforms such as <a href="https://developer.okta.com">Okta</a>, <a href="https://auth0.com">Auth0</a>, <a href="https://aws.amazon.com/cognito">AWS Cognito</a>, <a href="https://www.keycloak.org">Keycloak</a>, etc.</p>
</div>
<div class="paragraph">
<p>Once you create an application client with a provider, you will get a Client ID and optionally a Client Secret.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/aws-cognito-appclient.png" alt="aws cognito appclient">
</div>
</div>
<div class="paragraph">
<p>The previous image shows how to get an client id and client secret with AWS Cognito. Please, note you can obtain similar credentials with other providers.</p>
</div>
<div class="paragraph">
<p>Once, you get the <code>client_id</code> and <code>client_secret</code> configure the OAuth 2.0 configuration:</p>
</div>
<a id="io.micronaut.security.oauth2.configuration.OauthConfigurationProperties" href="#io.micronaut.security.oauth2.configuration.OauthConfigurationProperties">&#128279;</a>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Configuration Properties for <a href="../api/io/micronaut/security/oauth2/configuration/OauthConfigurationProperties.html">OauthConfigurationProperties</a></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.client-id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Oauth 2 Application Client ID.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.client-secret</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Oauth 2 Application Client Secret. Optional.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For example, if you configured:</p>
</div>
<div class="listingblock">
<div class="title">src/main/resources/application.yml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">micronaut:
  security:
    oauth2:
      client-secret: '${OAUTH_CLIENT_SECRET}'
      client-id: '${OAUTH_CLIENT_ID}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can supply two environment variables <code>OAUTH_CLIENT_SECRET</code>, <code>OAUTH_CLIENT_ID</code> with the credentials you obtained from the provider to be used as values of <code>micronaut.security.oauth2.client-id</code> and <code>micronaut.security.oauth2.client-secret</code>.</p>
</div>


<h1 id="openid">3 Open ID Connect</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/openid.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><a href="https://openid.net/connect/">OpenID Connect 1.0</a> is a simple identity layer on top of the OAuth 2.0 protocol. It allows Clients to verify the identity of the End-User based on the authentication performed by an Authorization Server, as well as to obtain basic profile information about the End-User in an interoperable and REST-like manner.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>If you are new to OpenID Connect, watch <a href="https://www.youtube.com/watch?v=996OiexHze0">OAuth 2.0 and OpenID Connect</a>.</p>
</div>


<h1 id="service-discovery">4 Service Discovery</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/service-discovery.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The easiest way to integrate a Micronaut application with an Open ID Connect server is to use the <code>.well-know/openid-configuration</code> endpoint, an endpoint which applications use to retrieve the configuration information for the OIDC server.</p>
</div>
<div class="paragraph">
<p>The endpoint returns a specified set of fields. Micronaut uses the configuration returned to configure itself accordingly.</p>
</div>
<div class="paragraph">
<p>Please, chek with your provider to locate the location of the <code>.well-know/openid-configuration</code>  configuration endpoint. Next, we show examples for common providers:</p>
</div>


<h2 id="service-discovery-okta">4.1 Service Discovery with OKTA</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/service-discovery/service-discovery-okta.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="listingblock">
<div class="title">src/main/resources/application.yml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">micronaut:
  security:
    oauth2:
      client-secret: '${OAUTH_CLIENT_SECRET}'
      client-id: '${OAUTH_CLIENT_ID}'
      openid-configuration: '${OKTA_DOMAIN}/oauth2/${OKTA_AUTHSERVERID}/.well-known/openid-configuration'</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will need to setup the <code>OKTA_DOMAIN</code> and <code>OKTA_AUTHSERVERID</code> environment variables.</p>
</div>
<div class="paragraph">
<p>Those may be something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export OKTA_DOMAIN=https://dev-XXXXX.oktapreview.com
export OKTA_AUTHSERVERID=default</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check <a href="https://developer.okta.com/docs/api/resources/oidc#well-knownopenid-configuration">OKTA .well-known/openid-configuration documentation</a>.</p>
</div>


<h2 id="service-discovery-cognito">4.2 Service Discovery with AWS Cognito</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/service-discovery/service-discovery-cognito.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To configure the <code>.well-know/openid-configuration</code> endpoint with AWS Cognito you can setup:</p>
</div>
<div class="listingblock">
<div class="title">src/main/resources/application.yml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">micronaut:
  security:
    oauth2:
      client-secret: '${OAUTH_CLIENT_SECRET}'
      client-id: '${OAUTH_CLIENT_ID}'
      openid-configuration: 'https://cognito-idp.${AWS_REGION}.amazonaws.com/${COGNITO_POOL_ID}/.well-known/openid-configuration'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please, note you will need to define environment varaibles for <code>AWS_REGION</code> and <code>COGNITO_POOL_ID</code>.</p>
</div>


<h2 id="service-discovery-auth0">4.3 Service Discovery with Auth0</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/service-discovery/service-discovery-auth0.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="listingblock">
<div class="title">src/main/resources/application.yml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">micronaut:
  security:
    oauth2:
      client-secret: '${OAUTH_CLIENT_SECRET}'
      client-id: '${OAUTH_CLIENT_ID}'
      openid-configuration: '${AUTH0_DOMAINNAME}/.well-known/openid-configuration'</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will need to define the environment variable <code>AUTH0_DOMAINNAME</code>.</p>
</div>
<div class="paragraph">
<p>You can obtain the auth0 domain from the application dashboard:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/auth0-domain.png" alt="auth0 domain">
</div>
</div>
<div class="paragraph">
<p>Check <a href="https://auth0.com/docs/protocols/oidc/openid-connect-discovery">Auth0 OpenID connect discovery documentation</a>.</p>
</div>


<h2 id="service-discovery-keycloak">4.4 Service Discovery with Keycloak</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/service-discovery/service-discovery-keycloak.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="listingblock">
<div class="title">src/main/resources/application.yml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">micronaut:
  security:
    oauth2:
      client-secret: '${OAUTH_CLIENT_SECRET}'
      client-id: '${OAUTH_CLIENT_ID}'
      openid-configuration: '${KEYCLOACK_DOMAIN}/auth/realms/${KEYCLOAK_REALM}/.well-known/openid-configuration'</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will need to define the environment variable <code>KEYCLOACK_DOMAIN</code> and <code>KEYCLOAK_REALM</code> for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export KEYCLOACK_DOMAIN=http://localhost:8080
export KEYCLOAK_REALM=master</code></pre>
</div>
</div>


<h1 id="endpoints">5 Endpoints</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/endpoints.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>





<h2 id="authorization">5.1 Authorization Endpoint</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/endpoints/authorization.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>If you use the Service discovery endpoint some of the configuration values required to communicate with the Authorization endpoint will be inferred from the service discovery endpoint response. For example, you will not need to configure the authorization endpoint&#8217;s url since that information is typically returned by service discovery endpoint. However, if the default values do not suffice, you can configure the communication with the authorization endpoint:</p>
</div>
<a id="io.micronaut.security.oauth2.openid.endpoints.authorization.AuthorizationEndpointConfigurationProperties" href="#io.micronaut.security.oauth2.openid.endpoints.authorization.AuthorizationEndpointConfigurationProperties">&#128279;</a>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Configuration Properties for <a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/AuthorizationEndpointConfigurationProperties.html">AuthorizationEndpointConfigurationProperties</a></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.authorization.url</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the authorization endpoint&#8217;s url.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.authorization.redirect-uri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redirection URI to which the response will be sent. Default value (<a href="http://localhost:8080/auth/code" class="bare">http://localhost:8080/auth/code</a>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.authorization.scopes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.util.List</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets OAuth 2.0 scopes. Default value (['openid']).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.authorization.response-type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set OAuth 2.0 Response Type. Default value ({@value #DEFAULT_RESPONSETYPE}).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.authorization.response-mode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Informs the Authorization Server of the mechanism to be used for returning parameters from the Authorization Endpoint. Default value ({@value #DEFAULT_RESPONSEMODE}).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.authorization.display</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/Display.html">Display</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASCII string value that specifies how the Authorization Server displays the authentication and consent user interface pages to the End-User. Default value (null).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.authorization.prompt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/Prompt.html">Prompt</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Space delimited, case sensitive list of ASCII string values that specifies whether the Authorization Server prompts the End-User for reauthentication and consent. Default value (null).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.authorization.max-age</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum Authentication Age. Default value (null).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.authorization.ui-locales</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.util.List</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">End-User&#8217;s preferred languages and scripts for the user interface. Default value (null).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.authorization.acr-values</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.util.List</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Requested Authentication Context Class Reference values. Default value (null).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The authorization request is built by default with <a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/DefaultAuthenticationRequestProvider.html">DefaultAuthenticationRequestProvider</a>. Remember you can always <a href="https://docs.micronaut.io/latest/guide/index.html#replaces">replace that bean</a> and provide your own implementation of <a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/AuthenticationRequestProvider.html">AuthenticationRequestProvider</a>.</p>
</div>


<h2 id="state">5.1.1 State</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/endpoints/authorization/state.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The default implementation does not provide an <a href="https://openid.net/specs/openid-connect-core-1_0.html#AuthRequest">Authentication Request state parameter</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Opaque value used to maintain state between the request and the callback. Typically, Cross-Site Request Forgery (CSRF, XSRF) mitigation is done by cryptographically binding the value of this parameter with a browser cookie.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>However, you can provide a <a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/StateProvider.html">StateProvider bean</a> and it will be included in the authentication request.</p>
</div>
<div class="paragraph">
<p>To validate the state received in the response provide an implementation of <a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/StateValidator.html">StateValidator bean</a>.</p>
</div>


<h2 id="idTokenHint">5.1.2 IDToken Hint</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/endpoints/authorization/idTokenHint.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The default implementation does not provide an <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDToken">ID Token hint</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>A Token previously issued by the Authorization Server being passed as a hint about the End-User&#8217;s current or past authenticated session with the Client.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>However, you can provide a <a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/IdTokenHintProvider.html">IdTokenHintProvider bean</a> and it will be included in the authentication request.</p>
</div>


<h2 id="loginHint">5.1.3 Login Hint</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/endpoints/authorization/loginHint.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The default implementation does not provide an <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDToken">login hint</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Hint to the Authorization Server about the login identifier the End-User might use to log in.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>However, you can provide a <a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/LoginHintProvider.html">LoginHintProvider bean</a> and it will be included in the authentication request.</p>
</div>


<h2 id="nonce">5.1.4 Nonce</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/endpoints/authorization/nonce.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The default implementation does not provide an <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDToken">Nonce parameter</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>A String value used to associate a Client session with an ID Token, and to mitigate replay attacks.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>However, you can provide a <a href="../api/io/micronaut/security/oauth2/openid/endpoints/authorization/NonceProvider.html">NonceProvider bean</a> and it will be included in the authentication request.</p>
</div>


<h2 id="token">5.2 Token Endpoint</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/endpoints/token.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>If you use the Service discovery endpoint some of the configuration values required to communicate with the <strong>Token endpoint</strong> will be inferred from the service discovery endpoint response. For example, you will not need to configure the token endpoint&#8217;s url since that information is typically returned by service discovery endpoint. However, if the default values do not suffice, you can configure the communication with the authorization endpoint:</p>
</div>
<a id="io.micronaut.security.oauth2.openid.endpoints.token.TokenEndpointConfigurationProperties" href="#io.micronaut.security.oauth2.openid.endpoints.token.TokenEndpointConfigurationProperties">&#128279;</a>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Configuration Properties for <a href="../api/io/micronaut/security/oauth2/openid/endpoints/token/TokenEndpointConfigurationProperties.html">TokenEndpointConfigurationProperties</a></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.token.url</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">token endpoint&#8217;s url</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.token.grant-type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Oauth 2.0. Grant Type. Default value (authorization_code).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.token.auth-method</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client Authentication method. By default no value is specified. In that case, the value returned by <a href="../api/io/micronaut/security/oauth2/openid/endpoints/token/AuthMethodProvider.html">AuthMethodProvider</a>, if such a bean exists, is used.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.token.content-type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/http/MediaType.html">MediaType</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Content-Type used to communicate with the token endpoint. Default value (application/x-www-form-urlencoded).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.token.redirect-uri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redirection URI to which the response will be sent.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The authorization request is built by default with <a href="../api/io/micronaut/security/oauth2/openid/endpoints/token/DefaultTokenRequestProvider.html">DefaultTokenRequestProvider</a>. Remember you can always <a href="https://docs.micronaut.io/latest/guide/index.html#replaces">replace that bean</a> and provide your own implementation of <a href="../api/io/micronaut/security/oauth2/openid/endpoints/token/TokenRequestProvider.html">TokenRequestProvider</a>.</p>
</div>


<h2 id="endsession">5.3 End Session Endpoint</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/endpoints/endsession.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>A logout process may look like the one displayed in the next image:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/logout-diagramm.png" alt="logout diagramm">
</div>
</div>
<div class="paragraph">
<p>Ending the session in the authorization server provider is not standard.</p>
</div>
<div class="paragraph">
<p>Micronaut provides several beans which are loaded by default.</p>
</div>
<div class="paragraph">
<p>The authorization server&#8217;s end session url is provided by an implementation of <a href="../api/io/micronaut/security/oauth2/openid/endpoints/endsession/EndSessionUrlProvider.html">EndSessionUrlProvider</a>. By default, <a href="../api/io/micronaut/security/oauth2/openid/endpoints/endsession/DefaultEndSessionUrlProvider.html">DefaultEndSessionUrlProvider</a> is used.</p>
</div>
<div class="paragraph">
<p>Micronaut attempts to create a valid configuration by default but you can always control the end-session endpoint configuration:</p>
</div>
<div class="paragraph">
<p>However, if the default values do not suffice, you can configure the communication with the authorization endpoint:</p>
</div>
<a id="io.micronaut.security.oauth2.openid.endpoints.endsession.EndSessionEndpointConfigurationProperties" href="#io.micronaut.security.oauth2.openid.endpoints.endsession.EndSessionEndpointConfigurationProperties">&#128279;</a>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Configuration Properties for <a href="../api/io/micronaut/security/oauth2/openid/endpoints/endsession/EndSessionEndpointConfigurationProperties.html">EndSessionEndpointConfigurationProperties</a></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.end-session.url</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The end-session endpoint url</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.end-session.redirect-uri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Redirection URI to which the response will be sent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.end-session.parameters</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.util.List</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">End-session endpoint parameters.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Several <a href="#providerSpecificBeans">Provider Specific beans</a> related to end session endpoint configuration are provided.</p>
</div>


<h2 id="logoutController">5.3.1 Logout Controller</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/endpoints/endsession/logoutController.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>You will need to enable the <a href="https://docs.micronaut.io/latest/guide/index.html#logout">Logout Controller</a> and accept GET requests.</p>
</div>
<div class="listingblock">
<div class="title">src/main/resources/application.yml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">micronaut:
    security:
        ...
        ..
        .
        endpoints:
            logout:
                enabled: true <i class="conum" data-value="1"></i><b>(1)</b>
                get-allowed: true <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Enable <a href="https://docs.micronaut.io/latest/guide/index.html#logout">Logout Controller</a>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Accept HTTP GET requests to the logout controller endpoint.</td>
</tr>
</table>
</div>


<h2 id="logouturl">5.3.2 Logout URL</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/endpoints/endsession/logouturl.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>If you are using <a href="https://docs.micronaut.io/latest/guide/index.html#views">Server side view rendering</a> support in Micronaut, the <a href="../api/io/micronaut/security/oauth2/openid/endpoints/endsession/EndsessionViewModelProcessor.html">EndsessionViewModelProcessor</a> injects into the model the logout url of the authorization server correctly configured.</p>
</div>
<a id="io.micronaut.security.oauth2.openid.endpoints.endsession.EndsessionViewModelProcessorConfigurationProperties" href="#io.micronaut.security.oauth2.openid.endpoints.endsession.EndsessionViewModelProcessorConfigurationProperties">&#128279;</a>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Configuration Properties for <a href="../api/io/micronaut/security/oauth2/openid/endpoints/endsession/EndsessionViewModelProcessorConfigurationProperties.html">EndsessionViewModelProcessorConfigurationProperties</a></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.end-session.view-model-processor.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets whether the {@link EndsessionViewModelProcessor} is enabled. Default value ({@value #DEFAULT_ENABLED}).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.end-session.view-model-processor.end-session-url-key</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Model key name. Default value ({@value #DEFAULT_ENDSESSIONURLKEY}).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Next code snippets shows a Velocity view which contains a link to logout.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-velocity hljs" data-lang="velocity">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Logout/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;a href="${endsessionurl}"&gt;Logout&lt;/a&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>


<h1 id="providerSpecificBeans">6 Provider Specific Beans</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/providerSpecificBeans.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="sect2">
<h3 id="_cognito">Cognito</h3>
<div class="paragraph">
<p>If the term <code>cognito</code> is present in the value of <code>micronaut.security.oauth2.openid-configuration</code> the next beans are loaded:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../api/io/micronaut/security/oauth2/openid/providers/AwsCognitoAuthMethodProvider.html">AwsCognitoAuthMethodProvider</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you want to disable that bean you can set <code>micronaut.security.oauth2.token.auth-method-provider.cognito</code> to <code>false</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../api/io/micronaut/security/oauth2/openid/providers/AwsCognitoEndSessionEndpointConfiguration.html">AwsCognitoEndSessionEndpointConfiguration</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you want to disable that bean you can set <code>micronaut.security.oauth2..end-session.aws-cognito.enabled</code> to <code>false</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_okta">Okta</h3>
<div class="paragraph">
<p>If the term <code>okta</code> is present in the value of <code>micronaut.security.oauth2.openid-configuration</code> the next beans are loaded:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../api/io/micronaut/security/oauth2/openid/providers/OktaEndSessionEndpointConfiguration.html">OktaEndSessionEndpointConfiguration</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you want to disable that bean you can set <code>micronaut.security.oauth2.end-session.okta.enabled</code> to <code>false</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_auth0">Auth0</h3>
<div class="paragraph">
<p>If the term <code>auth0</code> is present in the value of <code>micronaut.security.oauth2.openid-configuration</code> the next beans are loaded:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../api/io/micronaut/security/oauth2/openid/providers/Auth0EndSessionEndpointConfiguration.html">Auth0EndSessionEndpointConfiguration</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you want to disable that bean you can set <code>micronaut.security.oauth2.end-session.auth0.enabled</code> to <code>false</code></p>
</div>
</div>


<h1 id="flows">7 Flows</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/flows.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>





<h2 id="authorization-code-grant-type">7.1 OpenID Connect Authorization code Flow</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/flows/authorization-code-grant-type.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The following configuration illustrates a possible set up to use authorization code flow with Micronaut and a third-party OpenID Configuration authorization server.</p>
</div>
<div class="listingblock">
<div class="title">src/main/resources/application.yml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">micronaut:
    security:
        enabled: true <i class="conum" data-value="1"></i><b>(1)</b>
        oauth2:
          client-secret: '${OAUTH_CLIENT_SECRET}'  <i class="conum" data-value="2"></i><b>(2)</b>
          client-id: '${OAUTH_CLIENT_ID}' <i class="conum" data-value="3"></i><b>(3)</b>
          openid-configuration: '${OKTA_DOMAIN}/oauth2/${OKTA_AUTHSERVERID}/.well-known/ openid-configuration' <i class="conum" data-value="4"></i><b>(4)</b>
        token:
            jwt:
                enabled: true <i class="conum" data-value="5"></i><b>(5)</b>
                cookie:
                    enabled: true <i class="conum" data-value="6"></i><b>(6)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Enable security</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Client Secret. Your authorization server provider provides this value.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Client ID. Your authorization server provider provides this value.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><code>well-know openid-configuration</code> endpoint url. Allows micronaut to discover the configuration of the Open ID Configuration server.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Often, ID Token will be responded as JWT tokens. You will need to enable <a href="https://docs.micronaut.io/latest/guide/index.html#jwt">Micronaut&#8217;s JWT support</a> to validate it.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Once, validated you may want to save the JWT IDToken in a cookie. To read in subsequent requests, enable <a href="https://docs.micronaut.io/latest/guide/index.html#cookieToken">Cookie Token Reader</a>.</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/diagramm.png" alt="diagramm">
</div>
</div>


<h2 id="authorization-code-controller">7.1.1 Authorization Code Controller</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/flows/authorization-code-grant-type/authorization-code-controller.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The <a href="../api/io/micronaut/security/oauth2/endpoints/AuthorizationCodeController.html">AuthorizationCodeController controller</a> handles the response from the Authorization endpoint and it can be configured:</p>
</div>
<a id="io.micronaut.security.oauth2.endpoints.AuthorizationCodeControllerConfigurationProperties" href="#io.micronaut.security.oauth2.endpoints.AuthorizationCodeControllerConfigurationProperties">&#128279;</a>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Configuration Properties for <a href="../api/io/micronaut/security/oauth2/endpoints/AuthorizationCodeControllerConfigurationProperties.html">AuthorizationCodeControllerConfigurationProperties</a></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.endpoints.authcode.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets whether the {@link AuthorizationCodeController} is enabled. Default value ({@value #DEFAULT_ENABLED}).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.endpoints.authcode.controller-path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if the callback endpoint is /authcode/cb controller path will be /authcode.
 Default value ({@value #DEFAULT_CONTROLLERPATH}).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.endpoints.authcode.action-path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if the callback endpoint is /authcode/cb controller action path will be /cb . Default value ({@value #DEFAULT_ACTIONPATH}).</p></td>
</tr>
</tbody>
</table>


<h2 id="id-token-validator">7.1.2 ID Token Validator</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/flows/authorization-code-grant-type/id-token-validator.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Assuming the ID Token is a JWT token, the <a href="../api/io/micronaut/security/oauth2/openid/idtoken/DefaultIdTokenAccessTokenResponseValidator.html">DefaultIdTokenAccessTokenResponseValidator</a> validates the JWT Claims against every bean of type <a href="../api/io/micronaut/security/token/jwt/validator/GenericJwtClaimsValidator.html">GenericJwtClaimsValidator</a> and <a href="../api/io/micronaut/security/oauth2/openid/idtoken/validation/IdTokenClaimsValidator.html">IdTokenClaimsValidator</a>.</p>
</div>
<div class="paragraph">
<p>Some <a href="../api/io/micronaut/:io/micronaut/security/token/jwt/validator/GenericJwtClaimsValidator.html">GenericJwtClaimsValidator</a> are already registered:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../api/io/micronaut/security/token/jwt/validator/ExpirationJwtClaimsValidator.html">ExpirationJwtClaimsValidator</a></p>
</li>
<li>
<p><a href="../api/io/micronaut/security/token/jwt/validator/SubjectNotNullJwtClaimsValidator.html">SubjectNotNullJwtClaimsValidator</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Some <a href="../api/io/micronaut/security/oauth2/openid/idtoken/validation/IdTokenClaimsValidator.html">IdTokenClaimsValidator</a> are already registered:
and:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../api/io/micronaut/security/oauth2/openid/idtoken/validation/AudienceJwtClaimsValidator.html">AudienceJwtClaimsValidator</a></p>
</li>
<li>
<p><a href="../api/io/micronaut/security/oauth2/openid/idtoken/validation/IssuerJwtClaimsValidator.html">IssuerJwtClaimsValidator</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Please, validate your IDToken as described in the <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation">ID Token Validation</a> section.</p>
</div>
<div class="paragraph">
<p>Remember to enable JWT support <code>micronaut.security.token.jwt.enabled=true</code>.</p>
</div>


<h2 id="failure-handler">7.1.3 Failure Handler</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/flows/authorization-code-grant-type/failure-handler.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>If the validation of the <a href="../api/io/micronaut/security/oauth2/openid/idtoken/IdTokenAccessTokenResponse.html">IdTokenAccessTokenResponse</a>, an object which encapsulates the response of the token endpoint, fails a <a href="../api/io/micronaut/security/oauth2/handlers/InvalidIdTokenAccessTokenResponseException.html">InvalidIdTokenAccessTokenResponseException</a> is raised.</p>
</div>
<div class="paragraph">
<p>Read <a href="https://docs.micronaut.io/latest/guide/index.html#errorHandling">Error Handling</a> section in the documentation to handle the exception according to your needs.</p>
</div>


<h2 id="successful-handler">7.1.4 Successful ID Token Handler</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/flows/authorization-code-grant-type/successful-handler.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Once the authentication has been validated, it is to time handle the ID Token. Provide a bean of type:
<a href="../api/io/micronaut/security/oauth2/handlers/SuccessfulIdTokenAccessTokenResponseHandler.html">SuccessfulIdTokenAccessTokenResponseHandler</a></p>
</div>


<h2 id="cookie-successful-handler">7.1.5 Cookie Successful ID Token Handler</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/flows/authorization-code-grant-type/cookie-successful-handler.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>By default, <a href="../api/io/micronaut/security/oauth2/handlers/CookieSuccessfulIdTokenAccessTokenResponseHandler.html">CookieSuccessfulIdTokenAccessTokenResponseHandler</a> is provided which can be configured with:</p>
</div>
<a id="io.micronaut.security.oauth2.handlers.CookieSuccessfulIdTokenAccessTokenResponseHandlerConfigurationProperties" href="#io.micronaut.security.oauth2.handlers.CookieSuccessfulIdTokenAccessTokenResponseHandlerConfigurationProperties">&#128279;</a>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Configuration Properties for <a href="../api/io/micronaut/security/oauth2/handlers/CookieSuccessfulIdTokenAccessTokenResponseHandlerConfigurationProperties.html">CookieSuccessfulIdTokenAccessTokenResponseHandlerConfigurationProperties</a></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.openid.idtoken.cookie.cookie-name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cookie Name. Default value (JWT).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.openid.idtoken.cookie.cookie-domain</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the domain name of this Cookie. Default value (JWT).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.openid.idtoken.cookie.cookie-path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the path of the cookie. Default value ({@value #DEFAULT_COOKIEPATH}).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.openid.idtoken.cookie.login-success-target-url</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the login success target URL. Default value ({@value #DEFAULT_LOGINSUCCESSTARGETURL}).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.openid.idtoken.cookie.cookie-http-only</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether the Cookie can only be accessed via HTTP. Default value ({@value #DEFAULT_HTTPONLY}).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.openid.idtoken.cookie.cookie-secure</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets whether the cookie is secured. Default value ({@value #DEFAULT_SECURE}).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.openid.idtoken.cookie.cookie-max-age</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.time.temporal.TemporalAmount</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the maximum age of the cookie.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.openid.idtoken.cookie.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables <a href="../api/io/micronaut/security/oauth2/handlers/CookieSuccessfulIdTokenAccessTokenResponseHandler.html">CookieSuccessfulIdTokenAccessTokenResponseHandler</a>. Default value ({@value #DEFAULT_ENABLED}).</p></td>
</tr>
</tbody>
</table>


<h2 id="password-grant-type">7.2 Password Grant Type</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-oauth2/edit/master/src/main/docs/guide/password-grant-type.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>The Password grant is one of the simplest OAuth grants and involves only one step: the application presents a traditional username and password login form to collect the user&#8217;s credentials and makes a POST request to the server to exchange the password for an access token</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>For example, the next image illustrates a Basic auth authentication which does a remote grant type pasword authentication:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../img/grant-type-password.png" alt="grant type password">
</div>
</div>
<div class="paragraph">
<p>You can enable an implementation of <a href="https://docs.micronaut.io/latest/guide/index.html#authenticationProviders">Authentication Provider</a> to authenticate using Grant type password.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">micronaut:
  security:
    oauth2:
      client-secret: '${OAUTH_CLIENT_SECRET}'
      client-id: '${OAUTH_CLIENT_ID}'
      grant-type-password:
        enabled: true</code></pre>
</div>
</div>
<a id="io.micronaut.security.oauth2.grants.password.GrantTypePasswordRequestProviderConfigurationProperties" href="#io.micronaut.security.oauth2.grants.password.GrantTypePasswordRequestProviderConfigurationProperties">&#128279;</a>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Configuration Properties for <a href="../api/io/micronaut/security/oauth2/grants/password/GrantTypePasswordRequestProviderConfigurationProperties.html">GrantTypePasswordRequestProviderConfigurationProperties</a></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.grant-type-password.enabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets whether the {@link GrantTypePasswordRequestProvider} is enabled. Default value ({@value #DEFAULT_ENABLED}).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.grant-type-password.content-type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../api/io/micronaut/http/MediaType.html">MediaType</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Content-Type used to communicate with the token endpoint.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>micronaut.security.oauth2.grant-type-password.scopes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.util.List</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OAuth 2.0 scopes.</p></td>
</tr>
</tbody>
</table>

    </div>
</div>

<script type="text/javascript">

</script>
</body>
</html>